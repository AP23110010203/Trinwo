<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Create Portfolio - Form</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Quicksand:wght@400;600&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    />
    <style>
      .form-container {
        min-height: 100vh;
        font-family: "Quicksand", Arial, sans-serif;
        position: relative;
        z-index: 1;
      }
      /* Make sure content is above the video */
      body, html {
        height: 100%;
        margin: 0;
        padding: 0;
      }
      #bgVideo {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;      /* Always fill viewport width */
        height: 100vh;     /* Always fill viewport height */
        object-fit: cover; /* Crop to cover entire area */
        z-index: 0;
        pointer-events: none;
        min-width: 100vw;
        min-height: 100vh;
      }

      .form-card {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.3);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        border-radius: 20px;
      }

      .form-title {
        font-family: "Orbitron", sans-serif;
        letter-spacing: 2px;
        color: #2c3e50;
      }

      .btn-submit {
        font-family: "Orbitron", sans-serif;
        padding: 12px 30px;
        border-radius: 25px;
        background: linear-gradient(90deg, #4f8cff, #a084ee);
        border: none;
        transition: all 0.3s ease;
        font-weight: 600;
      }

      .btn-submit:hover {
        background: linear-gradient(90deg, #a084ee, #4f8cff);
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(79, 140, 255, 0.3);
      }

      .form-control:focus {
        border-color: #667eea;
        box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
      }

      .form-label {
        font-weight: 600;
        color: #2c3e50;
      }

      .navbar {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
      }

      .navbar-brand {
        font-family: "Orbitron", sans-serif;
        font-weight: 700;
        letter-spacing: 2px;
        color: white !important;
      }

      .nav-link {
        color: rgba(255, 255, 255, 0.9) !important;
        transition: all 0.3s ease;
      }

      .nav-link:hover {
        color: white !important;
        transform: translateY(-2px);
      }

      /* Credit link style */
      .video-credit {
        position: fixed;
        bottom: 5px;
        right: 10px;
        z-index: 2;
        font-size: 12px;
        color: #fff;
        text-shadow: 0 0 5px #000;
      }

      .video-credit a {
        color: #fff;
        text-decoration: underline;
      }
    </style>
  </head>
  <body>
    <!-- Background Video -->
    <video id="bgVideo" autoplay muted loop playsinline>
      <source src="Background.mp4" type="video/mp4">
      Your browser does not support the video tag.
    </video>

    <div class="form-container">
      <!-- Navigation -->
      <nav class="navbar navbar-expand-lg">
        <div class="container">
          <a class="navbar-brand" href="#">PORTFOLIO BUILDER</a>
          <button
            class="navbar-toggler"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#navbarNav"
          >
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ms-auto">
              <li class="nav-item">
                <a class="nav-link" href="index.html">Home</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="Choose template.html">Templates</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#contact">Contact</a>
              </li>
            </ul>
          </div>
        </div>
      </nav>

      <!-- Form Section -->
      <div class="container py-5">
        <div class="row justify-content-center">
          <div class="col-lg-8">
            <div class="form-card p-5">
              <h2 class="form-title text-center mb-4">Create Your Portfolio</h2>
              <p class="text-center mb-4 text-muted">
                Fill out the form below to create your professional portfolio
              </p>
              <div class="card mb-4 p-3">
                <h4>Analyze Your Resume</h4>
                <form id="resumeForm" enctype="multipart/form-data">
                  <input type="file" name="resume" id="resumeInput" accept="application/pdf" required />
                  <button type="submit" class="btn btn-primary">Analyze Resume</button>
                </form>
                <div id="resumeResult"></div>
              </div>
              <form
                id="portfolioForm"
                action="/Choose template.html"
                method="POST"
                enctype="multipart/form-data"
              >
                <div class="row">
                  <div class="col-md-6 mb-3">
                    <label for="name" class="form-label">Full Name *</label>
                    <input
                      type="text"
                      class="form-control"
                      id="name"
                      name="name"
                      required
                    />
                  </div>
                  <div class="col-md-6 mb-3">
                    <label for="email" class="form-label">Email *</label>
                    <input
                      type="email"
                      class="form-control"
                      id="email"
                      name="email"
                      required
                    />
                  </div>
                </div>

                <div class="row">
                  <div class="col-md-6 mb-3">
                    <label for="phone" class="form-label">Phone</label>
                    <input
                      type="tel"
                      class="form-control"
                      id="phone"
                      name="phone"
                    />
                  </div>
                  <div class="col-md-6 mb-3">
                    <label for="profession" class="form-label"
                      >Profession</label
                    >
                    <input
                      type="text"
                      class="form-control"
                      id="profession"
                      name="profession"
                      placeholder="e.g., Web Developer"
                    />
                  </div>
                </div>

                <div class="mb-3">
                  <label for="bio" class="form-label">Bio</label>
                  <textarea
                    id="bio"
                    name="bio"
                    class="form-control"
                    rows="3"
                    placeholder="Tell us about yourself..."
                  ></textarea>
                </div>

                <div class="mb-3">
                  <label for="skills" class="form-label"
                    >Skills (comma separated)</label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="skills"
                    name="skills"
                    placeholder="HTML, CSS, JavaScript, React"
                  />
                </div>

                <div class="mb-3">
                  <label for="projects" class="form-label"
                    >Projects (comma separated)</label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="projects"
                    name="projects"
                    placeholder="E-commerce Website, Portfolio, Mobile App"
                  />
                </div>

                <div class="mb-3">
                  <label for="services" class="form-label"
                    >Services (comma separated)</label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="services"
                    name="services"
                    placeholder="Web Development, UI/UX Design, Consulting"
                  />
                </div>

                <div class="row">
                  <div class="col-md-6 mb-3">
                    <label for="education" class="form-label">Education</label>
                    <input
                      type="text"
                      class="form-control"
                      id="education"
                      name="education"
                      placeholder="B.Tech Computer Science"
                    />
                  </div>
                  <div class="col-md-6 mb-3">
                    <label for="experience" class="form-label"
                      >Experience</label
                    >
                    <input
                      type="text"
                      class="form-control"
                      id="experience"
                      name="experience"
                      placeholder="2+ years"
                    />
                  </div>
                </div>

                <div class="mb-3">
                  <label for="address" class="form-label">Address</label>
                  <textarea
                    id="address"
                    name="address"
                    class="form-control"
                    rows="2"
                    placeholder="Your location"
                  ></textarea>
                </div>

                <div class="row">
                  <div class="col-md-6 mb-3">
                    <label for="linkedin" class="form-label"
                      >LinkedIn URL</label
                    >
                    <input
                      type="url"
                      class="form-control"
                      id="linkedin"
                      name="linkedin"
                    />
                  </div>
                  <div class="col-md-6 mb-3">
                    <label for="github" class="form-label">GitHub URL</label>
                    <input
                      type="url"
                      class="form-control"
                      id="github"
                      name="github"
                    />
                  </div>
                </div>

                <div class="row">
                  <div class="col-md-6 mb-3">
                    <label for="instagram" class="form-label"
                      >Instagram URL</label
                    >
                    <input
                      type="url"
                      class="form-control"
                      id="instagram"
                      name="instagram"
                    />
                  </div>
                  <div class="col-md-6 mb-3">
                    <label for="twitter" class="form-label">Twitter URL</label>
                    <input
                      type="url"
                      class="form-control"
                      id="twitter"
                      name="twitter"
                    />
                  </div>
                </div>

                <div class="mb-3">
                  <label for="facebook" class="form-label">Facebook URL</label>
                  <input
                    type="url"
                    class="form-control"
                    id="facebook"
                    name="facebook"
                  />
                </div>

                <div class="mb-3">
                  <label for="photo" class="form-label">Upload Photo</label>
                  <input
                    type="file"
                    class="form-control"
                    id="photo"
                    name="photo"
                    accept="image/*"
                  />
                </div>

                <div class="mb-3">
                  <label for="resume" class="form-label">Upload Resume</label>
                  <input
                    type="file"
                    class="form-control"
                    id="resume"
                    name="resume"
                    accept=".pdf,.doc,.docx"
                  />
                </div>

                <button type="submit" class="btn btn-submit w-100">
                  <i class="fas fa-rocket me-2"></i>Create Portfolio ✨
                </button>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>

   

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      // Optional: Add form validation or other client-side functionality
      document
        .getElementById("portfolioForm")
        .addEventListener("submit", function (e) {
          // You can add client-side validation here if needed
          // For backend, this will submit normally to your server
          console.log("Form submitted to backend");
        });

      // Add some interactive effects
      document.querySelectorAll(".form-control").forEach((input) => {
        input.addEventListener("focus", function () {
          this.parentElement.style.transform = "translateY(-2px)";
          this.parentElement.style.transition = "all 0.3s ease";
        });

        input.addEventListener("blur", function () {
          this.parentElement.style.transform = "translateY(0)";
        });
      });
    </script>
    <script>
      document
        .getElementById("portfolioForm")
        .addEventListener("submit", function (e) {
          e.preventDefault(); // Prevent the default POST behavior

          const formData = new FormData(this);
          const params = new URLSearchParams();

          formData.forEach((value, key) => {
            params.append(key, value);
          });

          // Redirect to template.html with query parameters
          window.location.href = "Choose template.html?" + params.toString();
        });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
  // Optional: Add form validation or other client-side functionality
  document.getElementById("portfolioForm").addEventListener("submit", function (e) {
    // You can add client-side validation here if needed
    // For backend, this will submit normally to your server
    console.log("Form submitted to backend");
  });

  // Add some interactive effects
  document.querySelectorAll(".form-control").forEach((input) => {
    input.addEventListener("focus", function () {
      this.parentElement.style.transform = "translateY(-2px)";
      this.parentElement.style.transition = "all 0.3s ease";
    });

    input.addEventListener("blur", function () {
      this.parentElement.style.transform = "translateY(0)";
    });
  });
</script>
<script>
  document.getElementById("portfolioForm").addEventListener("submit", function (e) {
    e.preventDefault(); // Prevent the default POST behavior

    const formData = new FormData(this);
    const params = new URLSearchParams();

    formData.forEach((value, key) => {
      params.append(key, value);
    });

    // Redirect to template.html with query parameters
    window.location.href = "Choose template.html?" + params.toString();
  });
</script>
<script>
  document.addEventListener("DOMContentLoaded", () => {
    const form = document.getElementById("portfolioForm");
    const photoInput = document.getElementById("photo");
    const resumeInput = document.getElementById("resume");

    form.addEventListener("submit", function (e) {
      e.preventDefault(); // Prevent the default POST behavior

      const formData = new FormData(this);
      let portfolioData = {};

      // Collect text data
      formData.forEach((value, key) => {
        if (key !== "photo" && key !== "resume") {
          portfolioData[key] = value;
        }
      });

      // Handle photo upload
      if (photoInput.files[0]) {
        const reader = new FileReader();
        reader.onload = (event) => {
          portfolioData.photoURL = event.target.result;
          handleResumeAndRedirect(portfolioData, resumeInput.files[0]);
        };
        reader.readAsDataURL(photoInput.files[0]);
      } else {
        handleResumeAndRedirect(portfolioData, resumeInput.files[0]);
      }
    });

    function handleResumeAndRedirect(portfolioData, resumeFile) {
      if (resumeFile) {
        const reader = new FileReader();
        reader.onload = (event) => {
          portfolioData.resumeName = resumeFile.name;
          portfolioData.resumeDataUrl = event.target.result;
          localStorage.setItem("portfolio_data", JSON.stringify(portfolioData));
          window.location.href = "Choose template.html";
        };
        reader.readAsDataURL(resumeFile);
      } else {
        localStorage.setItem("portfolio_data", JSON.stringify(portfolioData));
        window.location.href = "Choose template.html";
      }
    }
  });

  document.addEventListener("DOMContentLoaded", () => {
  const form = document.getElementById("portfolioForm");
  const photoInput = document.getElementById("photo");
  const resumeInput = document.getElementById("resume");

  form.addEventListener("submit", function (e) {
    e.preventDefault(); // Prevent default form submission

    const formData = new FormData(this);
    let portfolioData = {};

    // Collect text data
    formData.forEach((value, key) => {
      if (key !== "photo" && key !== "resume") {
        portfolioData[key] = value;
      }
    });

    // Handle photo upload
    if (photoInput.files[0]) {
      const reader = new FileReader();
      reader.onload = (event) => {
        portfolioData.photoURL = event.target.result;
        handleResumeAndRedirect(portfolioData, resumeInput.files[0]);
      };
      reader.readAsDataURL(photoInput.files[0]);
    } else {
      handleResumeAndRedirect(portfolioData, resumeInput.files[0]);
    }
  });

  function handleResumeAndRedirect(portfolioData, resumeFile) {
    // Handle resume upload
    if (resumeFile) {
      const reader = new FileReader();
      reader.onload = (event) => {
        portfolioData.resumeName = resumeFile.name;
        portfolioData.resumeDataUrl = event.target.result;
        saveAndRedirect(portfolioData);
      };
      reader.readAsDataURL(resumeFile);
    } else {
      saveAndRedirect(portfolioData);
    }
  }

  function saveAndRedirect(portfolioData) {
    // Save data to localStorage
    localStorage.setItem("portfolio_data", JSON.stringify(portfolioData));
    // Redirect to template
    window.location.href = "choose template.html";
  }
});

document.addEventListener('DOMContentLoaded', function() {
  fetch('https://sam-ac7u.onrender.com/api/resume/latest')
    .then(response => response.json())
    .then(data => {
      if (data.resumeData) {
        const { name, email, phone, skills, projects, socialLinks, bio } = data.resumeData;
        document.getElementById('name').value = name || '';
        document.getElementById('email').value = email || '';
        document.getElementById('phone').value = phone || '';
        document.getElementById('skills').value = (skills && skills.length) ? skills.join(', ') : '';
        document.getElementById('projects').value = (projects && projects.length) ? projects.join('; ') : '';
        document.getElementById('bio').value = bio || '';
        // Map social links to their respective fields
        if (Array.isArray(socialLinks)) {
          socialLinks.forEach(link => {
            if (link.includes('linkedin.com')) document.getElementById('linkedin').value = link;
            if (link.includes('github.com')) document.getElementById('github').value = link;
            if (link.includes('instagram.com')) document.getElementById('instagram').value = link;
            if (link.includes('twitter.com')) document.getElementById('twitter').value = link;
            if (link.includes('facebook.com')) document.getElementById('facebook').value = link;
          });
        }
      }
    })
    .catch(err => {
      console.log('Error fetching resume data:', err);
    });
});

// Add Analyze Resume button functionality
function fillFormWithResumeData(data) {
  if (data.resumeData) {
    const { name, email, phone, skills, projects, services, profession, education, experience, address, bio, socialLinks, linkedin, github, instagram, twitter, facebook } = data.resumeData;
    document.getElementById('name').value = name || '';
    document.getElementById('email').value = email || '';
    document.getElementById('phone').value = phone || '';
    document.getElementById('skills').value = (skills && skills.length) ? skills.join(', ') : '';
    document.getElementById('projects').value = (projects && projects.length) ? projects.join('; ') : '';
    document.getElementById('services').value = (services && services.length) ? services.join(', ') : '';
    document.getElementById('profession').value = profession || '';
    document.getElementById('education').value = education || '';
    document.getElementById('experience').value = experience || '';
    document.getElementById('address').value = address || '';
    document.getElementById('bio').value = bio || '';
    // Map social links to their respective fields
    if (linkedin) document.getElementById('linkedin').value = linkedin;
    if (github) document.getElementById('github').value = github;
    if (instagram) document.getElementById('instagram').value = instagram;
    if (twitter) document.getElementById('twitter').value = twitter;
    if (facebook) document.getElementById('facebook').value = facebook;
    // Fallback: fill from socialLinks array if not already filled
    if (Array.isArray(socialLinks)) {
      socialLinks.forEach(link => {
        if (link.includes('linkedin.com') && !document.getElementById('linkedin').value) document.getElementById('linkedin').value = link;
        if (link.includes('github.com') && !document.getElementById('github').value) document.getElementById('github').value = link;
        if (link.includes('instagram.com') && !document.getElementById('instagram').value) document.getElementById('instagram').value = link;
        if (link.includes('twitter.com') && !document.getElementById('twitter').value) document.getElementById('twitter').value = link;
        if (link.includes('facebook.com') && !document.getElementById('facebook').value) document.getElementById('facebook').value = link;
      });
    }
  }
}

// Resume extraction and auto-fill logic
if (document.getElementById('resumeForm')) {
  document.getElementById('resumeForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    const formData = new FormData();
    const fileInput = document.getElementById('resumeInput');
    if (!fileInput.files[0]) {
      document.getElementById('resumeResult').textContent = 'Please select a PDF file.';
      return;
    }
    formData.append('resume', fileInput.files[0]);
    document.getElementById('resumeResult').innerHTML = 'Analyzing...';
    try {
      const response = await fetch('https://sam-ac7u.onrender.com/api/resume', {
        method: 'POST',
        body: formData
      });
      if (!response.ok) {
        document.getElementById('resumeResult').textContent = 'Server error: ' + response.status;
        return;
      }
      const data = await response.json();
      if (data.resumeData) {
        document.getElementById('resumeResult').innerHTML = '<span style="color:green;">Extraction complete! Form auto-filled below.</span>';
        fillFormWithResumeData(data);
      } else if (data.error) {
        document.getElementById('resumeResult').textContent = 'Error: ' + data.error;
      } else {
        document.getElementById('resumeResult').textContent = 'Failed to extract data.';
      }
    } catch (err) {
      document.getElementById('resumeResult').textContent = 'Error: ' + err.message;
    }
  });
}

</script>

</body>

  </body>
</html>